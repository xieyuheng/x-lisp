;; (define (fibonacci n)
;;   (if (< n 2)
;;     n
;;     (+ (fibonacci (- n 1)) (fibonacci (- n 2)))))

(define-function (fibonacci n)
  (block entry
    (test (int-less? n 2))
    (branch base-case recur-case))
  (block base-case
    (return n))
  (block recur-case
    (= n1 (isub n 1))
    (= f1 (fibonacci n1))
    (= n2 (isub n 2))
    (= f2 (fibonacci n2))
    (= r (iadd n1 n2))
    (return r)))
