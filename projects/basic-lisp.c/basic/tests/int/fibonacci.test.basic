;; (define (fibonacci n)
;;   (if (int-less-or-equal? n 1)
;;     n
;;     (iadd (fibonacci (isub n 1))
;;           (fibonacci (isub n 2)))))

(define-function (fibonacci n)
  (block body
    (test (int-less-or-equal? n 1))
    (branch base-case recur-case))
  (block base-case
    (return n))
  (block recur-case
    (= n1 (isub n 1))
    (= f1 (fibonacci n1))
    (= n2 (isub n 2))
    (= f2 (fibonacci n2))
    (return (iadd f1 f2))))

(define-function (main)
  (block body
    (= v (fibonacci 0))
    (perform (println v))
    (= v (fibonacci 1))
    (perform (println v))
    (= v (fibonacci 2))
    (perform (println v))
    (= v (fibonacci 3))
    (perform (println v))
    (= v (fibonacci 4))
    (perform (println v))
    (= v (fibonacci 5))
    (perform (println v))
    (= v (fibonacci 6))
    (perform (println v))
    (= v (fibonacci 7))
    (perform (println v))
    (= v (fibonacci 8))
    (perform (println v))
    (= v (fibonacci 9))
    (perform (println v))
    (return void)))
