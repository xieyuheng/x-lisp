;;; Input

(define (gcd a b) (if (equal? b 0) a (gcd b (imod a b))))

(define (main)
  (assert-equal 1 (gcd 13 7))
  (assert-equal 4 (gcd 12 8)))

;;; Loaded

(define (gcd a b) (if (equal? b 0) a (gcd b (imod a b))))

(define (main)
  (assert-equal 1 (gcd 13 7))
  (assert-equal 4 (gcd 12 8)))

;;; ShrinkPass

(define (gcd a b) (if (equal? b 0) a (gcd b (imod a b))))

(define (main)
  (assert-equal 1 (gcd 13 7))
  (assert-equal 4 (gcd 12 8)))

;;; UniquifyPass

(define (gcd a b) (if (equal? b 0) a (gcd b (imod a b))))

(define (main)
  (assert-equal 1 (gcd 13 7))
  (assert-equal 4 (gcd 12 8)))

;;; LiftLambdaPass

(define (gcd a b) (if (equal? b 0) a (gcd b (imod a b))))

(define (main)
  (assert-equal 1 (gcd 13 7))
  (assert-equal 4 (gcd 12 8)))

;;; UnnestOperandPass

(define (gcd a b)
  (if (equal? b 0) a (begin (= _₁ (imod a b)) (gcd b _₁))))

(define (main)
  (begin (= _₁ (gcd 13 7)) (assert-equal 1 _₁))
  (= _₂ (gcd 12 8))
  (assert-equal 4 _₂))

