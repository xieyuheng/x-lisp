(define-function (fibonacci n)
  (block entry
    (test (int-less-or-equal? n 1))
    (branch then₁ else₂))
  (block then₁ (return n))
  (block else₂
    (= _₁ (isub n 1))
    (= _₂ (fibonacci _₁))
    (= _₃ (isub n 2))
    (= _₄ (fibonacci _₃))
    (return (iadd _₂ _₄))))

(define-function (main)
  (block entry
    (= _₁ (fibonacci 0))
    (perform (assert-equal 0 _₁))
    (= _₂ (fibonacci 1))
    (perform (assert-equal 1 _₂))
    (= _₃ (fibonacci 2))
    (perform (assert-equal 1 _₃))
    (= _₄ (fibonacci 3))
    (perform (assert-equal 2 _₄))
    (= _₅ (fibonacci 4))
    (perform (assert-equal 3 _₅))
    (= _₆ (fibonacci 5))
    (perform (assert-equal 5 _₆))
    (= _₇ (fibonacci 6))
    (perform (assert-equal 8 _₇))
    (= _₈ (fibonacci 7))
    (perform (assert-equal 13 _₈))
    (= _₉ (fibonacci 8))
    (perform (assert-equal 21 _₉))
    (= _₁₀ (fibonacci 9))
    (return (assert-equal 34 _₁₀))))
