;;; Input

(define (main)
  (= list (make-list))
  (list-push! 1 list)
  (list-push! 2 list)
  (list-push! 3 list)
  (println list)
  (println [1 2 3])
  (println '(1 2 3))
  (println [1 2 3])
  (println [1 2 3])
  (println ['a 'b 'c])
  (println '(a b c)))

;;; ShrinkPass

(define (main)
  (let ((list (make-list)))
    (begin
      (list-push! 1 list)
      (begin
        (list-push! 2 list)
        (begin
          (list-push! 3 list)
          (begin
            (println list)
            (begin
              (println
               (let ((tael (make-list)))
                 (begin
                   (list-push! 1 tael)
                   (begin
                     (list-push! 2 tael)
                     (begin (list-push! 3 tael) tael)))))
              (begin
                (println
                 (let ((tael (make-list)))
                   (begin
                     (list-push! 1 tael)
                     (begin
                       (list-push! 2 tael)
                       (begin (list-push! 3 tael) tael)))))
                (begin
                  (println
                   (let ((tael (make-list)))
                     (begin
                       (list-push! 1 tael)
                       (begin
                         (list-push! 2 tael)
                         (begin (list-push! 3 tael) tael)))))
                  (begin
                    (println
                     (let ((tael (make-list)))
                       (begin
                         (list-push! 1 tael)
                         (begin
                           (list-push! 2 tael)
                           (begin (list-push! 3 tael) tael)))))
                    (begin
                      (println
                       (let ((tael (make-list)))
                         (begin
                           (list-push! 'a tael)
                           (begin
                             (list-push! 'b tael)
                             (begin
                               (list-push! 'c tael)
                               tael)))))
                      (println
                       (let ((tael (make-list)))
                         (begin
                           (list-push! 'a tael)
                           (begin
                             (list-push! 'b tael)
                             (begin
                               (list-push! 'c tael)
                               tael))))))))))))))))

;;; UniquifyPass

(define (main)
  (let ((list₁ (make-list)))
    (begin
      (list-push! 1 list₁)
      (begin
        (list-push! 2 list₁)
        (begin
          (list-push! 3 list₁)
          (begin
            (println list₁)
            (begin
              (println
               (let ((tael₁ (make-list)))
                 (begin
                   (list-push! 1 tael₁)
                   (begin
                     (list-push! 2 tael₁)
                     (begin (list-push! 3 tael₁) tael₁)))))
              (begin
                (println
                 (let ((tael₁ (make-list)))
                   (begin
                     (list-push! 1 tael₁)
                     (begin
                       (list-push! 2 tael₁)
                       (begin (list-push! 3 tael₁) tael₁)))))
                (begin
                  (println
                   (let ((tael₁ (make-list)))
                     (begin
                       (list-push! 1 tael₁)
                       (begin
                         (list-push! 2 tael₁)
                         (begin (list-push! 3 tael₁) tael₁)))))
                  (begin
                    (println
                     (let ((tael₁ (make-list)))
                       (begin
                         (list-push! 1 tael₁)
                         (begin
                           (list-push! 2 tael₁)
                           (begin
                             (list-push! 3 tael₁)
                             tael₁)))))
                    (begin
                      (println
                       (let ((tael₁ (make-list)))
                         (begin
                           (list-push! 'a tael₁)
                           (begin
                             (list-push! 'b tael₁)
                             (begin
                               (list-push! 'c tael₁)
                               tael₁)))))
                      (println
                       (let ((tael₁ (make-list)))
                         (begin
                           (list-push! 'a tael₁)
                           (begin
                             (list-push! 'b tael₁)
                             (begin
                               (list-push! 'c tael₁)
                               tael₁))))))))))))))))

;;; RevealGlobalPass

(define (main)
  (let ((list₁ (make-list)))
    (begin
      (list-push! 1 list₁)
      (begin
        (list-push! 2 list₁)
        (begin
          (list-push! 3 list₁)
          (begin
            (println list₁)
            (begin
              (println
               (let ((tael₁ (make-list)))
                 (begin
                   (list-push! 1 tael₁)
                   (begin
                     (list-push! 2 tael₁)
                     (begin (list-push! 3 tael₁) tael₁)))))
              (begin
                (println
                 (let ((tael₁ (make-list)))
                   (begin
                     (list-push! 1 tael₁)
                     (begin
                       (list-push! 2 tael₁)
                       (begin (list-push! 3 tael₁) tael₁)))))
                (begin
                  (println
                   (let ((tael₁ (make-list)))
                     (begin
                       (list-push! 1 tael₁)
                       (begin
                         (list-push! 2 tael₁)
                         (begin (list-push! 3 tael₁) tael₁)))))
                  (begin
                    (println
                     (let ((tael₁ (make-list)))
                       (begin
                         (list-push! 1 tael₁)
                         (begin
                           (list-push! 2 tael₁)
                           (begin
                             (list-push! 3 tael₁)
                             tael₁)))))
                    (begin
                      (println
                       (let ((tael₁ (make-list)))
                         (begin
                           (list-push! 'a tael₁)
                           (begin
                             (list-push! 'b tael₁)
                             (begin
                               (list-push! 'c tael₁)
                               tael₁)))))
                      (println
                       (let ((tael₁ (make-list)))
                         (begin
                           (list-push! 'a tael₁)
                           (begin
                             (list-push! 'b tael₁)
                             (begin
                               (list-push! 'c tael₁)
                               tael₁))))))))))))))))

;;; LiftLambdaPass

(define (main)
  (let ((list₁ (make-list)))
    (begin
      (list-push! 1 list₁)
      (begin
        (list-push! 2 list₁)
        (begin
          (list-push! 3 list₁)
          (begin
            (println list₁)
            (begin
              (println
               (let ((tael₁ (make-list)))
                 (begin
                   (list-push! 1 tael₁)
                   (begin
                     (list-push! 2 tael₁)
                     (begin (list-push! 3 tael₁) tael₁)))))
              (begin
                (println
                 (let ((tael₁ (make-list)))
                   (begin
                     (list-push! 1 tael₁)
                     (begin
                       (list-push! 2 tael₁)
                       (begin (list-push! 3 tael₁) tael₁)))))
                (begin
                  (println
                   (let ((tael₁ (make-list)))
                     (begin
                       (list-push! 1 tael₁)
                       (begin
                         (list-push! 2 tael₁)
                         (begin (list-push! 3 tael₁) tael₁)))))
                  (begin
                    (println
                     (let ((tael₁ (make-list)))
                       (begin
                         (list-push! 1 tael₁)
                         (begin
                           (list-push! 2 tael₁)
                           (begin
                             (list-push! 3 tael₁)
                             tael₁)))))
                    (begin
                      (println
                       (let ((tael₁ (make-list)))
                         (begin
                           (list-push! 'a tael₁)
                           (begin
                             (list-push! 'b tael₁)
                             (begin
                               (list-push! 'c tael₁)
                               tael₁)))))
                      (println
                       (let ((tael₁ (make-list)))
                         (begin
                           (list-push! 'a tael₁)
                           (begin
                             (list-push! 'b tael₁)
                             (begin
                               (list-push! 'c tael₁)
                               tael₁))))))))))))))))

;;; UnnestOperandPass

(define (main)
  (let ((list₁ (make-list)))
    (begin
      (list-push! 1 list₁)
      (begin
        (list-push! 2 list₁)
        (begin
          (list-push! 3 list₁)
          (begin
            (println list₁)
            (begin
              (let ((tael₁ (make-list)))
                (begin
                  (list-push! 1 tael₁)
                  (begin
                    (list-push! 2 tael₁)
                    (begin
                      (list-push! 3 tael₁)
                      (println tael₁)))))
              (begin
                (let ((tael₁ (make-list)))
                  (begin
                    (list-push! 1 tael₁)
                    (begin
                      (list-push! 2 tael₁)
                      (begin
                        (list-push! 3 tael₁)
                        (println tael₁)))))
                (begin
                  (let ((tael₁ (make-list)))
                    (begin
                      (list-push! 1 tael₁)
                      (begin
                        (list-push! 2 tael₁)
                        (begin
                          (list-push! 3 tael₁)
                          (println tael₁)))))
                  (begin
                    (let ((tael₁ (make-list)))
                      (begin
                        (list-push! 1 tael₁)
                        (begin
                          (list-push! 2 tael₁)
                          (begin
                            (list-push! 3 tael₁)
                            (println tael₁)))))
                    (begin
                      (let ((tael₁ (make-list)))
                        (begin
                          (list-push! 'a tael₁)
                          (begin
                            (list-push! 'b tael₁)
                            (begin
                              (list-push! 'c tael₁)
                              (println tael₁)))))
                      (let ((tael₁ (make-list)))
                        (begin
                          (list-push! 'a tael₁)
                          (begin
                            (list-push! 'b tael₁)
                            (begin
                              (list-push! 'c tael₁)
                              (println tael₁))))))))))))))))

