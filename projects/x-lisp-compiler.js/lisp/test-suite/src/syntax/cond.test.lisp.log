;;; Input

(define (main)
  (assert-equal
    1
    (cond ((equal? 1 1) (begin 1)) (#t (begin 2))))
  (assert-equal
    2
    (cond ((equal? 1 2) (begin 1)) (#t (begin 2))))
  (cond
    ((equal? 1 1) (begin (assert true)))
    (#t (begin (assert false))))
  (cond
    ((equal? 1 2) (begin (assert false)))
    (#t (begin (assert true)))))

;;; Loaded

(define (main)
  (assert-equal
    1
    (cond ((equal? 1 1) (begin 1)) (#t (begin 2))))
  (assert-equal
    2
    (cond ((equal? 1 2) (begin 1)) (#t (begin 2))))
  (cond
    ((equal? 1 1) (begin (assert true)))
    (#t (begin (assert false))))
  (cond
    ((equal? 1 2) (begin (assert false)))
    (#t (begin (assert true)))))

;;; ShrinkPass

(define (main)
  (assert-equal 1 (if (equal? 1 1) 1 (if #t 2 (assert #f))))
  (assert-equal 2 (if (equal? 1 2) 1 (if #t 2 (assert #f))))
  (if (equal? 1 1)
    (assert true)
    (if #t (assert false) (assert #f)))
  (if (equal? 1 2)
    (assert false)
    (if #t (assert true) (assert #f))))

;;; UniquifyPass

(define (main)
  (assert-equal 1 (if (equal? 1 1) 1 (if #t 2 (assert #f))))
  (assert-equal 2 (if (equal? 1 2) 1 (if #t 2 (assert #f))))
  (if (equal? 1 1)
    (assert true)
    (if #t (assert false) (assert #f)))
  (if (equal? 1 2)
    (assert false)
    (if #t (assert true) (assert #f))))

;;; RevealGlobalPass

(define (main)
  (assert-equal 1 (if (equal? 1 1) 1 (if #t 2 (assert #f))))
  (assert-equal 2 (if (equal? 1 2) 1 (if #t 2 (assert #f))))
  (if (equal? 1 1)
    (assert true)
    (if #t (assert false) (assert #f)))
  (if (equal? 1 2)
    (assert false)
    (if #t (assert true) (assert #f))))

;;; LiftLambdaPass

(define (main)
  (assert-equal 1 (if (equal? 1 1) 1 (if #t 2 (assert #f))))
  (assert-equal 2 (if (equal? 1 2) 1 (if #t 2 (assert #f))))
  (if (equal? 1 1)
    (assert true)
    (if #t (assert false) (assert #f)))
  (if (equal? 1 2)
    (assert false)
    (if #t (assert true) (assert #f))))

;;; UnnestOperandPass

(define (main)
  (begin
    (= _₁ (if (equal? 1 1) 1 (if #t 2 (assert #f))))
    (assert-equal 1 _₁))
  (begin
    (= _₂ (if (equal? 1 2) 1 (if #t 2 (assert #f))))
    (assert-equal 2 _₂))
  (if (equal? 1 1)
    (begin (= _₃ true) (assert _₃))
    (if #t (begin (= _₄ false) (assert _₄)) (assert #f)))
  (if (equal? 1 2)
    (begin (= _₅ false) (assert _₅))
    (if #t (begin (= _₆ true) (assert _₆)) (assert #f))))

