;;; Input

(define (main)
  (assert-equal 1 (cond (#t (begin 1)) (#t (begin 2))))
  (assert-equal 2 (cond (#f (begin 1)) (#t (begin 2))))
  (cond (#t (begin (assert true))) (#t (begin (assert false))))
  (cond (#f (begin (assert false))) (#t (begin (assert true)))))

;;; ShrinkPass

(define (main)
  (begin
    (assert-equal 1 (if #t 1 (if #t 2 (assert #f))))
    (begin
      (assert-equal 2 (if #f 1 (if #t 2 (assert #f))))
      (begin
        (if #t (assert true) (if #t (assert false) (assert #f)))
        (if #f (assert false) (if #t (assert true) (assert #f)))))))

;;; UniquifyPass

(define (main)
  (begin
    (assert-equal 1 (if #t 1 (if #t 2 (assert #f))))
    (begin
      (assert-equal 2 (if #f 1 (if #t 2 (assert #f))))
      (begin
        (if #t (assert true) (if #t (assert false) (assert #f)))
        (if #f (assert false) (if #t (assert true) (assert #f)))))))

;;; RevealGlobalPass

(define (main)
  (begin
    ((@primitive assert-equal 2)
     1
     (if #t 1 (if #t 2 ((@primitive assert 1) #f))))
    (begin
      ((@primitive assert-equal 2)
       2
       (if #f 1 (if #t 2 ((@primitive assert 1) #f))))
      (begin
        (if #t
          ((@primitive assert 1) (@constant true))
          (if #t
            ((@primitive assert 1) (@constant false))
            ((@primitive assert 1) #f)))
        (if #f
          ((@primitive assert 1) (@constant false))
          (if #t
            ((@primitive assert 1) (@constant true))
            ((@primitive assert 1) #f)))))))

;;; LiftLambdaPass

(define (main)
  (begin
    ((@primitive assert-equal 2)
     1
     (if #t 1 (if #t 2 ((@primitive assert 1) #f))))
    (begin
      ((@primitive assert-equal 2)
       2
       (if #f 1 (if #t 2 ((@primitive assert 1) #f))))
      (begin
        (if #t
          ((@primitive assert 1) (@constant true))
          (if #t
            ((@primitive assert 1) (@constant false))
            ((@primitive assert 1) #f)))
        (if #f
          ((@primitive assert 1) (@constant false))
          (if #t
            ((@primitive assert 1) (@constant true))
            ((@primitive assert 1) #f)))))))

;;; UnnestOperandPass

(define (main)
  (begin
    (let ((_₁ (if #t 1 (if #t 2 ((@primitive assert 1) #f)))))
      ((@primitive assert-equal 2) 1 _₁))
    (begin
      (let ((_₂ (if #f 1 (if #t 2 ((@primitive assert 1) #f)))))
        ((@primitive assert-equal 2) 2 _₂))
      (begin
        (if #t
          (let ((_₃ (@constant true)))
            ((@primitive assert 1) _₃))
          (if #t
            (let ((_₄ (@constant false)))
              ((@primitive assert 1) _₄))
            ((@primitive assert 1) #f)))
        (if #f
          (let ((_₅ (@constant false)))
            ((@primitive assert 1) _₅))
          (if #t
            (let ((_₆ (@constant true)))
              ((@primitive assert 1) _₆))
            ((@primitive assert 1) #f)))))))

