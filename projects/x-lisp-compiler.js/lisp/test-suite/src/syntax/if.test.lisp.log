;;; Input

(define (main)
  (assert-equal (if #t 1 2) 1)
  (assert-equal (if #f 1 2) 2)
  (assert (and #t #t #t))
  (assert (not (and #t #t #f)))
  (assert (or #f #f #t))
  (assert (not (or #f #f #f))))

;;; Loaded

(define (main)
  (assert-equal (if #t 1 2) 1)
  (assert-equal (if #f 1 2) 2)
  (assert (and #t #t #t))
  (assert (not (and #t #t #f)))
  (assert (or #f #f #t))
  (assert (not (or #f #f #f))))

;;; ShrinkPass

(define (main)
  (assert-equal (if #t 1 2) 1)
  (assert-equal (if #f 1 2) 2)
  (assert (if #t (if #t #t #f) #f))
  (assert (not (if #t (if #t #f #f) #f)))
  (assert (if #f #t (if #f #t #t)))
  (assert (not (if #f #t (if #f #t #f)))))

;;; UniquifyPass

(define (main)
  (assert-equal (if #t 1 2) 1)
  (assert-equal (if #f 1 2) 2)
  (assert (if #t (if #t #t #f) #f))
  (assert (not (if #t (if #t #f #f) #f)))
  (assert (if #f #t (if #f #t #t)))
  (assert (not (if #f #t (if #f #t #f)))))

;;; RevealGlobalPass

(define (main)
  (assert-equal (if #t 1 2) 1)
  (assert-equal (if #f 1 2) 2)
  (assert (if #t (if #t #t #f) #f))
  (assert (not (if #t (if #t #f #f) #f)))
  (assert (if #f #t (if #f #t #t)))
  (assert (not (if #f #t (if #f #t #f)))))

;;; LiftLambdaPass

(define (main)
  (assert-equal (if #t 1 2) 1)
  (assert-equal (if #f 1 2) 2)
  (assert (if #t (if #t #t #f) #f))
  (assert (not (if #t (if #t #f #f) #f)))
  (assert (if #f #t (if #f #t #t)))
  (assert (not (if #f #t (if #f #t #f)))))

;;; UnnestOperandPass

(define (main)
  (begin (= _₁ (if #t 1 2)) (assert-equal _₁ 1))
  (begin (= _₂ (if #f 1 2)) (assert-equal _₂ 2))
  (begin (= _₃ (if #t (if #t #t #f) #f)) (assert _₃))
  (begin
    (= _₄ (if #t (if #t #f #f) #f))
    (= _₅ (not _₄))
    (assert _₅))
  (begin (= _₆ (if #f #t (if #f #t #t))) (assert _₆))
  (= _₇ (if #f #t (if #f #t #f)))
  (= _₈ (not _₇))
  (assert _₈))

