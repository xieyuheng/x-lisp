;;; Input

(define (main)
  (assert-equal (if #t 1 2) 1)
  (assert-equal (if #f 1 2) 2)
  (assert (and #t #t #t))
  (assert (not (and #t #t #f)))
  (assert (or #f #f #t))
  (assert (not (or #f #f #f))))

;;; ShrinkPass

(define (main)
  (begin
    (assert-equal (if #t 1 2) 1)
    (assert-equal (if #f 1 2) 2)
    (assert (if #t (if #t #t #f) #f))
    (assert (not (if #t (if #t #f #f) #f)))
    (assert (if #f #t (if #f #t #t)))
    (assert (not (if #f #t (if #f #t #f))))))

;;; UniquifyPass

(define (main)
  (begin
    (assert-equal (if #t 1 2) 1)
    (assert-equal (if #f 1 2) 2)
    (assert (if #t (if #t #t #f) #f))
    (assert (not (if #t (if #t #f #f) #f)))
    (assert (if #f #t (if #f #t #t)))
    (assert (not (if #f #t (if #f #t #f))))))

;;; RevealGlobalPass

(define (main)
  (begin
    (assert-equal (if #t 1 2) 1)
    (assert-equal (if #f 1 2) 2)
    (assert (if #t (if #t #t #f) #f))
    (assert (not (if #t (if #t #f #f) #f)))
    (assert (if #f #t (if #f #t #t)))
    (assert (not (if #f #t (if #f #t #f))))))

;;; LiftLambdaPass

(define (main)
  (begin
    (assert-equal (if #t 1 2) 1)
    (assert-equal (if #f 1 2) 2)
    (assert (if #t (if #t #t #f) #f))
    (assert (not (if #t (if #t #f #f) #f)))
    (assert (if #f #t (if #f #t #t)))
    (assert (not (if #f #t (if #f #t #f))))))

;;; UnnestOperandPass

(define (main)
  (begin
    (let ((_₁ (if #t 1 2))) (assert-equal _₁ 1))
    (let ((_₂ (if #f 1 2))) (assert-equal _₂ 2))
    (let ((_₃ (if #t (if #t #t #f) #f))) (assert _₃))
    (let ((_₄ (if #t (if #t #f #f) #f)))
      (let ((_₅ (not _₄))) (assert _₅)))
    (let ((_₆ (if #f #t (if #f #t #t)))) (assert _₆))
    (let ((_₇ (if #f #t (if #f #t #f))))
      (let ((_₈ (not _₇))) (assert _₈)))))

