;;; Input

(define (main)
  (println (@hash))
  (println (@hash 1 2))
  (println (@hash 1 3))
  (println (@hash 1 2 3 4)))

;;; ShrinkPass

(define (main)
  (begin
    (println (let ((hash (make-hash))) hash))
    (begin
      (println
       (let ((hash (make-hash)))
         (begin (hash-put! 1 2 hash) hash)))
      (begin
        (println
         (let ((hash (make-hash)))
           (begin (hash-put! 1 3 hash) hash)))
        (println
         (let ((hash (make-hash)))
           (begin
             (hash-put! 1 2 hash)
             (begin (hash-put! 3 4 hash) hash))))))))

;;; UniquifyPass

(define (main)
  (begin
    (println (let ((hash₁ (make-hash))) hash₁))
    (begin
      (println
       (let ((hash₁ (make-hash)))
         (begin (hash-put! 1 2 hash₁) hash₁)))
      (begin
        (println
         (let ((hash₁ (make-hash)))
           (begin (hash-put! 1 3 hash₁) hash₁)))
        (println
         (let ((hash₁ (make-hash)))
           (begin
             (hash-put! 1 2 hash₁)
             (begin (hash-put! 3 4 hash₁) hash₁))))))))

;;; RevealGlobalPass

(define (main)
  (begin
    ((@primitive println 1)
     (let ((hash₁ ((@primitive make-hash 0)))) hash₁))
    (begin
      ((@primitive println 1)
       (let ((hash₁ ((@primitive make-hash 0))))
         (begin ((@primitive hash-put! 3) 1 2 hash₁) hash₁)))
      (begin
        ((@primitive println 1)
         (let ((hash₁ ((@primitive make-hash 0))))
           (begin ((@primitive hash-put! 3) 1 3 hash₁) hash₁)))
        ((@primitive println 1)
         (let ((hash₁ ((@primitive make-hash 0))))
           (begin
             ((@primitive hash-put! 3) 1 2 hash₁)
             (begin ((@primitive hash-put! 3) 3 4 hash₁) hash₁))))))))

;;; LiftLambdaPass

(define (main)
  (begin
    ((@primitive println 1)
     (let ((hash₁ ((@primitive make-hash 0)))) hash₁))
    (begin
      ((@primitive println 1)
       (let ((hash₁ ((@primitive make-hash 0))))
         (begin ((@primitive hash-put! 3) 1 2 hash₁) hash₁)))
      (begin
        ((@primitive println 1)
         (let ((hash₁ ((@primitive make-hash 0))))
           (begin ((@primitive hash-put! 3) 1 3 hash₁) hash₁)))
        ((@primitive println 1)
         (let ((hash₁ ((@primitive make-hash 0))))
           (begin
             ((@primitive hash-put! 3) 1 2 hash₁)
             (begin ((@primitive hash-put! 3) 3 4 hash₁) hash₁))))))))

;;; UnnestOperandPass

(define (main)
  (begin
    (let ((hash₁ ((@primitive make-hash 0))))
      ((@primitive println 1) hash₁))
    (begin
      (let ((hash₁ ((@primitive make-hash 0))))
        (begin
          ((@primitive hash-put! 3) 1 2 hash₁)
          ((@primitive println 1) hash₁)))
      (begin
        (let ((hash₁ ((@primitive make-hash 0))))
          (begin
            ((@primitive hash-put! 3) 1 3 hash₁)
            ((@primitive println 1) hash₁)))
        (let ((hash₁ ((@primitive make-hash 0))))
          (begin
            ((@primitive hash-put! 3) 1 2 hash₁)
            (begin
              ((@primitive hash-put! 3) 3 4 hash₁)
              ((@primitive println 1) hash₁))))))))

