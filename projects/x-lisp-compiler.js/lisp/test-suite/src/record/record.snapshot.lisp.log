;;; Input

(define (main)
  (println '(:x a :y b))
  (println [:x 'a :y 'b])
  (println [:x 'a :y 'b])
  (println [:x 'a :y 'b]))

;;; ShrinkPass

(define (main)
  (begin
    (println
     (let ((tael (make-list)))
       (begin
         (record-put! 'x 'a tael)
         (record-put! 'y 'b tael)
         tael)))
    (println
     (let ((tael (make-list)))
       (begin
         (record-put! 'x 'a tael)
         (record-put! 'y 'b tael)
         tael)))
    (println
     (let ((tael (make-list)))
       (begin
         (record-put! 'x 'a tael)
         (record-put! 'y 'b tael)
         tael)))
    (println
     (let ((tael (make-list)))
       (begin
         (record-put! 'x 'a tael)
         (record-put! 'y 'b tael)
         tael)))))

;;; UniquifyPass

(define (main)
  (begin
    (println
     (let ((tael₁ (make-list)))
       (begin
         (record-put! 'x 'a tael₁)
         (record-put! 'y 'b tael₁)
         tael₁)))
    (println
     (let ((tael₁ (make-list)))
       (begin
         (record-put! 'x 'a tael₁)
         (record-put! 'y 'b tael₁)
         tael₁)))
    (println
     (let ((tael₁ (make-list)))
       (begin
         (record-put! 'x 'a tael₁)
         (record-put! 'y 'b tael₁)
         tael₁)))
    (println
     (let ((tael₁ (make-list)))
       (begin
         (record-put! 'x 'a tael₁)
         (record-put! 'y 'b tael₁)
         tael₁)))))

;;; RevealGlobalPass

(define (main)
  (begin
    (println
     (let ((tael₁ (make-list)))
       (begin
         (record-put! 'x 'a tael₁)
         (record-put! 'y 'b tael₁)
         tael₁)))
    (println
     (let ((tael₁ (make-list)))
       (begin
         (record-put! 'x 'a tael₁)
         (record-put! 'y 'b tael₁)
         tael₁)))
    (println
     (let ((tael₁ (make-list)))
       (begin
         (record-put! 'x 'a tael₁)
         (record-put! 'y 'b tael₁)
         tael₁)))
    (println
     (let ((tael₁ (make-list)))
       (begin
         (record-put! 'x 'a tael₁)
         (record-put! 'y 'b tael₁)
         tael₁)))))

;;; LiftLambdaPass

(define (main)
  (begin
    (println
     (let ((tael₁ (make-list)))
       (begin
         (record-put! 'x 'a tael₁)
         (record-put! 'y 'b tael₁)
         tael₁)))
    (println
     (let ((tael₁ (make-list)))
       (begin
         (record-put! 'x 'a tael₁)
         (record-put! 'y 'b tael₁)
         tael₁)))
    (println
     (let ((tael₁ (make-list)))
       (begin
         (record-put! 'x 'a tael₁)
         (record-put! 'y 'b tael₁)
         tael₁)))
    (println
     (let ((tael₁ (make-list)))
       (begin
         (record-put! 'x 'a tael₁)
         (record-put! 'y 'b tael₁)
         tael₁)))))

;;; UnnestOperandPass

(define (main)
  (begin
    (let ((tael₁ (make-list)))
      (begin
        (record-put! 'x 'a tael₁)
        (record-put! 'y 'b tael₁)
        (println tael₁)))
    (let ((tael₁ (make-list)))
      (begin
        (record-put! 'x 'a tael₁)
        (record-put! 'y 'b tael₁)
        (println tael₁)))
    (let ((tael₁ (make-list)))
      (begin
        (record-put! 'x 'a tael₁)
        (record-put! 'y 'b tael₁)
        (println tael₁)))
    (let ((tael₁ (make-list)))
      (begin
        (record-put! 'x 'a tael₁)
        (record-put! 'y 'b tael₁)
        (println tael₁)))))

