(import-all "my-list")

(define-function (main)
  (block body
    (perform (assert-equal nil #nil))
    (= _₁ (li 3 nil))
    (= _₂ (li 2 _₁))
    (= _₃ (li 1 _₂))
    (= tael₁ (make-list))
    (perform (list-push! #li tael₁))
    (perform (list-push! 1 tael₁))
    (= tael₂ (make-list))
    (perform (list-push! #li tael₂))
    (perform (list-push! 2 tael₂))
    (= tael₃ (make-list))
    (perform (list-push! #li tael₃))
    (perform (list-push! 3 tael₃))
    (perform (list-push! #nil tael₃))
    (perform (list-push! tael₃ tael₂))
    (perform (list-push! tael₂ tael₁))
    (perform (assert-equal _₃ tael₁))
    (= _₄ (li 1 nil))
    (= _₅ (li-tail _₄))
    (perform (assert-equal _₅ nil))
    (= _₆ (li 1 nil))
    (= _₇ (li-head _₆))
    (perform (assert-equal _₇ 1))
    (= _₈ (li 3 nil))
    (= _₉ (li 2 _₈))
    (= list₁ (li 1 _₉))
    (= _₁₀ (li-head list₁))
    (perform (assert-equal _₁₀ 1))
    (perform (li-put-head! 111 list₁))
    (= _₁₁ (li-head list₁))
    (perform (assert-equal _₁₁ 111))
    (= _₁₂ (li-tail list₁))
    (= _₁₃ (li 3 nil))
    (= _₁₄ (li 2 _₁₃))
    (perform (assert-equal _₁₂ _₁₄))
    (perform (li-put-tail! nil list₁))
    (= _₁₅ (li-tail list₁))
    (perform (assert-equal _₁₅ nil))
    (= _₁₆ (li 1 nil))
    (= _₁₇ (li 1))
    (= _₁₈ (_₁₇ nil))
    (return (assert-equal _₁₆ _₁₈))))
