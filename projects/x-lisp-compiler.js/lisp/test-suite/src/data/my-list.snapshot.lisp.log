;;; Input

(import-all "my-list")

(define (main)
  (println nil)
  (println (li 1 (li 2 (li 3 nil)))))

;;; Loaded

(define (main)
  (println nil)
  (println (li 1 (li 2 (li 3 nil)))))

(define nil #nil)

(define (li head tail) [#li head tail])

(define (li-head target) (list-get 1 target))

(define (li-tail target) (list-get 2 target))

(define (li-put-head value target)
  (list-put 1 value target))

(define (li-put-tail value target)
  (list-put 2 value target))

(define (li-put-head! value target)
  (list-put! 1 value target))

(define (li-put-tail! value target)
  (list-put! 2 value target))

;;; ShrinkPass

(define (main)
  (println nil)
  (println (li 1 (li 2 (li 3 nil)))))

(define nil #nil)

(define (li head tail) [#li head tail])

(define (li-head target) (list-get 1 target))

(define (li-tail target) (list-get 2 target))

(define (li-put-head value target)
  (list-put 1 value target))

(define (li-put-tail value target)
  (list-put 2 value target))

(define (li-put-head! value target)
  (list-put! 1 value target))

(define (li-put-tail! value target)
  (list-put! 2 value target))

;;; UniquifyPass

(define (main)
  (println nil)
  (println (li 1 (li 2 (li 3 nil)))))

(define nil #nil)

(define (li head tail) [#li head tail])

(define (li-head target) (list-get 1 target))

(define (li-tail target) (list-get 2 target))

(define (li-put-head value target)
  (list-put 1 value target))

(define (li-put-tail value target)
  (list-put 2 value target))

(define (li-put-head! value target)
  (list-put! 1 value target))

(define (li-put-tail! value target)
  (list-put! 2 value target))

;;; RevealGlobalPass

(define (main)
  (println nil)
  (println (li 1 (li 2 (li 3 nil)))))

(define nil #nil)

(define (li head tail) [#li head tail])

(define (li-head target) (list-get 1 target))

(define (li-tail target) (list-get 2 target))

(define (li-put-head value target)
  (list-put 1 value target))

(define (li-put-tail value target)
  (list-put 2 value target))

(define (li-put-head! value target)
  (list-put! 1 value target))

(define (li-put-tail! value target)
  (list-put! 2 value target))

;;; LiftLambdaPass

(define (main)
  (println nil)
  (println (li 1 (li 2 (li 3 nil)))))

;;; UnnestOperandPass

(define (main)
  (begin (= _₁ nil) (println _₁))
  (= _₂ nil)
  (= _₃ (li 3 _₂))
  (= _₄ (li 2 _₃))
  (= _₅ (li 1 _₄))
  (println _₅))

