;;; Input

(export
  nil
  li
  li-head
  li-tail
  li-put-head
  li-put-tail
  li-put-head!
  li-put-tail!)

(define nil #nil)

(define (li head tail) [#li head tail])

(define (li-head target) (list-get 1 target))

(define (li-tail target) (list-get 2 target))

(define (li-put-head value target)
  (list-put 1 value target))

(define (li-put-tail value target)
  (list-put 2 value target))

(define (li-put-head! value target)
  (list-put! 1 value target))

(define (li-put-tail! value target)
  (list-put! 2 value target))

;;; ShrinkPass

(export
  nil
  li
  li-head
  li-tail
  li-put-head
  li-put-tail
  li-put-head!
  li-put-tail!)

(define nil #nil)

(define (li head tail)
  (let ((tael (make-list)))
    (begin
      (list-push! #li tael)
      (begin
        (list-push! head tael)
        (begin (list-push! tail tael) tael)))))

(define (li-head target) (list-get 1 target))

(define (li-tail target) (list-get 2 target))

(define (li-put-head value target)
  (list-put 1 value target))

(define (li-put-tail value target)
  (list-put 2 value target))

(define (li-put-head! value target)
  (list-put! 1 value target))

(define (li-put-tail! value target)
  (list-put! 2 value target))

;;; UniquifyPass

(export
  nil
  li
  li-head
  li-tail
  li-put-head
  li-put-tail
  li-put-head!
  li-put-tail!)

(define nil #nil)

(define (li head tail)
  (let ((tael₁ (make-list)))
    (begin
      (list-push! #li tael₁)
      (begin
        (list-push! head tael₁)
        (begin (list-push! tail tael₁) tael₁)))))

(define (li-head target) (list-get 1 target))

(define (li-tail target) (list-get 2 target))

(define (li-put-head value target)
  (list-put 1 value target))

(define (li-put-tail value target)
  (list-put 2 value target))

(define (li-put-head! value target)
  (list-put! 1 value target))

(define (li-put-tail! value target)
  (list-put! 2 value target))

;;; RevealGlobalPass

(export
  nil
  li
  li-head
  li-tail
  li-put-head
  li-put-tail
  li-put-head!
  li-put-tail!)

(define nil #nil)

(define (li head tail)
  (let ((tael₁ (make-list)))
    (begin
      (list-push! #li tael₁)
      (begin
        (list-push! head tael₁)
        (begin (list-push! tail tael₁) tael₁)))))

(define (li-head target) (list-get 1 target))

(define (li-tail target) (list-get 2 target))

(define (li-put-head value target)
  (list-put 1 value target))

(define (li-put-tail value target)
  (list-put 2 value target))

(define (li-put-head! value target)
  (list-put! 1 value target))

(define (li-put-tail! value target)
  (list-put! 2 value target))

;;; LiftLambdaPass

(export
  nil
  li
  li-head
  li-tail
  li-put-head
  li-put-tail
  li-put-head!
  li-put-tail!)

(define nil #nil)

(define (li head tail)
  (let ((tael₁ (make-list)))
    (begin
      (list-push! #li tael₁)
      (begin
        (list-push! head tael₁)
        (begin (list-push! tail tael₁) tael₁)))))

(define (li-head target) (list-get 1 target))

(define (li-tail target) (list-get 2 target))

(define (li-put-head value target)
  (list-put 1 value target))

(define (li-put-tail value target)
  (list-put 2 value target))

(define (li-put-head! value target)
  (list-put! 1 value target))

(define (li-put-tail! value target)
  (list-put! 2 value target))

;;; UnnestOperandPass

(export
  nil
  li
  li-head
  li-tail
  li-put-head
  li-put-tail
  li-put-head!
  li-put-tail!)

(define nil #nil)

(define (li head tail)
  (let ((tael₁ (make-list)))
    (begin
      (list-push! #li tael₁)
      (begin
        (list-push! head tael₁)
        (begin (list-push! tail tael₁) tael₁)))))

(define (li-head target) (list-get 1 target))

(define (li-tail target) (list-get 2 target))

(define (li-put-head value target)
  (list-put 1 value target))

(define (li-put-tail value target)
  (list-put 2 value target))

(define (li-put-head! value target)
  (list-put! 1 value target))

(define (li-put-tail! value target)
  (list-put! 2 value target))

