;;; Input

(import-all "my-list")

(define (main)
  (assert-equal nil nil)
  (assert-equal
    (li 1 (li 2 (li 3 nil)))
    (li 1 (li 2 (li 3 nil))))
  (assert-equal (li-tail (li 1 nil)) nil)
  (assert-equal (li-head (li 1 nil)) nil))

(define nil #nil)

(define (li head tail) [#li head tail])

(define (li-head target) (list-get 1 target))

(define (li-tail target) (list-get 2 target))

;;; ShrinkPass

(import-all "my-list")

(define (main)
  (begin
    (assert-equal nil nil)
    (begin
      (assert-equal
        (li 1 (li 2 (li 3 nil)))
        (li 1 (li 2 (li 3 nil))))
      (begin
        (assert-equal (li-tail (li 1 nil)) nil)
        (assert-equal (li-head (li 1 nil)) nil)))))

(define nil #nil)

(define (li head tail) [#li head tail])

(define (li-head target) (list-get 1 target))

(define (li-tail target) (list-get 2 target))

;;; UniquifyPass

(import-all "my-list")

(define (main)
  (begin
    (assert-equal nil nil)
    (begin
      (assert-equal
        (li 1 (li 2 (li 3 nil)))
        (li 1 (li 2 (li 3 nil))))
      (begin
        (assert-equal (li-tail (li 1 nil)) nil)
        (assert-equal (li-head (li 1 nil)) nil)))))

(define nil #nil)

(define (li head tail) [#li head tail])

(define (li-head target) (list-get 1 target))

(define (li-tail target) (list-get 2 target))

;;; RevealGlobalPass

(import-all "my-list")

(define (main)
  (begin
    (assert-equal nil nil)
    (begin
      (assert-equal
        (li 1 (li 2 (li 3 nil)))
        (li 1 (li 2 (li 3 nil))))
      (begin
        (assert-equal (li-tail (li 1 nil)) nil)
        (assert-equal (li-head (li 1 nil)) nil)))))

(define nil #nil)

(define (li head tail) [#li head tail])

(define (li-head target) (list-get 1 target))

(define (li-tail target) (list-get 2 target))

;;; LiftLambdaPass

(import-all "my-list")

(define (main)
  (begin
    (assert-equal nil nil)
    (begin
      (assert-equal
        (li 1 (li 2 (li 3 nil)))
        (li 1 (li 2 (li 3 nil))))
      (begin
        (assert-equal (li-tail (li 1 nil)) nil)
        (assert-equal (li-head (li 1 nil)) nil)))))

;;; UnnestOperandPass

(import-all "my-list")

(define (main)
  (begin
    (let ((_₁ nil)) (let ((_₂ nil)) (assert-equal _₁ _₂)))
    (begin
      (let ((_₃ nil))
        (let ((_₄ (li 3 _₃)))
          (let ((_₅ (li 2 _₄)))
            (let ((_₆ (li 1 _₅)))
              (let ((_₇ nil))
                (let ((_₈ (li 3 _₇)))
                  (let ((_₉ (li 2 _₈)))
                    (let ((_₁₀ (li 1 _₉)))
                      (assert-equal _₆ _₁₀)))))))))
      (begin
        (let ((_₁₁ nil))
          (let ((_₁₂ (li 1 _₁₁)))
            (let ((_₁₃ (li-tail _₁₂)))
              (let ((_₁₄ nil)) (assert-equal _₁₃ _₁₄)))))
        (let ((_₁₅ nil))
          (let ((_₁₆ (li 1 _₁₅)))
            (let ((_₁₇ (li-head _₁₆)))
              (let ((_₁₈ nil)) (assert-equal _₁₇ _₁₈)))))))))

