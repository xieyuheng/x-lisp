;;; Input

(define one 1)

(define two (iadd 1 one))

(define three (iadd 1 two))

(define (main) (println three))

;;; ShrinkPass

(define one 1)

(define two (iadd 1 one))

(define three (iadd 1 two))

(define (main) (println three))

;;; UniquifyPass

(define one 1)

(define two (iadd 1 one))

(define three (iadd 1 two))

(define (main) (println three))

;;; RevealGlobalPass

(define one 1)

(define two ((@primitive-function-ref iadd 2) 1 (@constant-ref one)))

(define three ((@primitive-function-ref iadd 2) 1 (@constant-ref two)))

(define (main) ((@primitive-function-ref println 1) (@constant-ref three)))

;;; LiftLambdaPass

(define one 1)

(define two ((@primitive-function-ref iadd 2) 1 (@constant-ref one)))

(define three ((@primitive-function-ref iadd 2) 1 (@constant-ref two)))

(define (main) ((@primitive-function-ref println 1) (@constant-ref three)))

;;; UnnestOperandPass

(define one 1)

(define two
  (@let1 _₁ (@constant-ref one) ((@primitive-function-ref iadd 2) 1 _₁)))

(define three
  (@let1 _₁ (@constant-ref two) ((@primitive-function-ref iadd 2) 1 _₁)))

(define (main)
  (@let1 _₁ (@constant-ref three) ((@primitive-function-ref println 1) _₁)))

