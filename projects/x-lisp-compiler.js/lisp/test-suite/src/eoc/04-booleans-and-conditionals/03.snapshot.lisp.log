;;; Input

(define (main)
  (println (if (and (equal? (random-dice) 1) (equal? (random-dice) 2)) 0 42)))

;;; ShrinkPass

(define (main)
  (println (if (if (equal? (random-dice) 1) (equal? (random-dice) 2) #f) 0 42)))

;;; UniquifyPass

(define (main)
  (println (if (if (equal? (random-dice) 1) (equal? (random-dice) 2) #f) 0 42)))

;;; RevealGlobalPass

(define (main)
  ((@primitive-function-ref println 1)
   (if
       (if
           ((@primitive-function-ref equal? 2)
            ((@primitive-function-ref random-dice 0))
            1)
         ((@primitive-function-ref equal? 2)
          ((@primitive-function-ref random-dice 0))
          2)
         #f)
     0
     42)))

;;; LiftLambdaPass

(define (main)
  ((@primitive-function-ref println 1)
   (if
       (if
           ((@primitive-function-ref equal? 2)
            ((@primitive-function-ref random-dice 0))
            1)
         ((@primitive-function-ref equal? 2)
          ((@primitive-function-ref random-dice 0))
          2)
         #f)
     0
     42)))

;;; UnnestOperandPass

(define (main)
  (@let1 _₁
      (@let1 _₂
          (@let1 _₃ ((@primitive-function-ref random-dice 0))
            (@let1 _₄ ((@primitive-function-ref equal? 2) _₃ 1)
              (if _₄
                (@let1 _₅ ((@primitive-function-ref random-dice 0))
                  ((@primitive-function-ref equal? 2) _₅ 2))
                #f)))
        (if _₂ 0 42))
    ((@primitive-function-ref println 1) _₁)))

