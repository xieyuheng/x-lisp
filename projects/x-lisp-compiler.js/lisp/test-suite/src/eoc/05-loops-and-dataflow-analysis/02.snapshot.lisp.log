;;; Input

(define (main)
  (= x
     (begin
       (print 1)
       (newline)
       (print 2)
       (newline)
       (print 3)
       (newline)
       6))
  (begin
    (print 4)
    (newline)
    (print 5)
    (newline)
    (print 6)
    (newline)
    (iadd x x)))

;;; ShrinkPass

(define (main)
  (@let1 x
      (@let1 _∅ (print 1)
        (@let1 _∅ (newline)
          (@let1 _∅ (print 2)
            (@let1 _∅ (newline)
              (@let1 _∅ (print 3) (@let1 _∅ (newline) 6))))))
    (@let1 _∅ (print 4)
      (@let1 _∅ (newline)
        (@let1 _∅ (print 5)
          (@let1 _∅ (newline)
            (@let1 _∅ (print 6)
              (@let1 _∅ (newline) ((iadd x) x)))))))))

;;; UniquifyPass

(define (main)
  (@let1 x₁
      (@let1 _∅₁ (print 1)
        (@let1 _∅₂ (newline)
          (@let1 _∅₃ (print 2)
            (@let1 _∅₄ (newline)
              (@let1 _∅₅ (print 3) (@let1 _∅₆ (newline) 6))))))
    (@let1 _∅₁ (print 4)
      (@let1 _∅₂ (newline)
        (@let1 _∅₃ (print 5)
          (@let1 _∅₄ (newline)
            (@let1 _∅₅ (print 6)
              (@let1 _∅₆ (newline) ((iadd x₁) x₁)))))))))

;;; RevealGlobalPass

(define (main)
  (@let1 x₁
      (@let1 _∅₁ ((@builtin-function-ref print 1) 1)
        (@let1 _∅₂ ((@builtin-function-ref newline 0))
          (@let1 _∅₃ ((@builtin-function-ref print 1) 2)
            (@let1 _∅₄ ((@builtin-function-ref newline 0))
              (@let1 _∅₅ ((@builtin-function-ref print 1) 3)
                (@let1 _∅₆
                    ((@builtin-function-ref newline 0))
                  6))))))
    (@let1 _∅₁ ((@builtin-function-ref print 1) 4)
      (@let1 _∅₂ ((@builtin-function-ref newline 0))
        (@let1 _∅₃ ((@builtin-function-ref print 1) 5)
          (@let1 _∅₄ ((@builtin-function-ref newline 0))
            (@let1 _∅₅ ((@builtin-function-ref print 1) 6)
              (@let1 _∅₆ ((@builtin-function-ref newline 0))
                (((@builtin-function-ref iadd 2) x₁) x₁)))))))))

;;; LiftLambdaPass

(define (main)
  (@let1 x₁
      (@let1 _∅₁ ((@builtin-function-ref print 1) 1)
        (@let1 _∅₂ ((@builtin-function-ref newline 0))
          (@let1 _∅₃ ((@builtin-function-ref print 1) 2)
            (@let1 _∅₄ ((@builtin-function-ref newline 0))
              (@let1 _∅₅ ((@builtin-function-ref print 1) 3)
                (@let1 _∅₆
                    ((@builtin-function-ref newline 0))
                  6))))))
    (@let1 _∅₁ ((@builtin-function-ref print 1) 4)
      (@let1 _∅₂ ((@builtin-function-ref newline 0))
        (@let1 _∅₃ ((@builtin-function-ref print 1) 5)
          (@let1 _∅₄ ((@builtin-function-ref newline 0))
            (@let1 _∅₅ ((@builtin-function-ref print 1) 6)
              (@let1 _∅₆ ((@builtin-function-ref newline 0))
                (((@builtin-function-ref iadd 2) x₁) x₁)))))))))

