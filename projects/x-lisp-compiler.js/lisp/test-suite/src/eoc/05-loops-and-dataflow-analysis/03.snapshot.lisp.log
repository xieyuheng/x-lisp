;;; Input

(define (main)
  (if
      (begin
        (print 1)
        (newline)
        (print 2)
        (newline)
        (print 3)
        (newline)
        (equal? 1 2))
    (begin (print 111) (newline) (equal? 1 2))
    (begin (print 222) (newline) (equal? 1 2))))

;;; ShrinkPass

(define (main)
  (if
      (@begin1 (print 1)
        (@begin1 (newline)
          (@begin1 (print 2)
            (@begin1 (newline)
              (@begin1 (print 3)
                (@begin1 (newline) (equal? 1 2)))))))
    (@begin1 (print 111) (@begin1 (newline) (equal? 1 2)))
    (@begin1 (print 222) (@begin1 (newline) (equal? 1 2)))))

;;; UniquifyPass

(define (main)
  (if
      (@begin1 (print 1)
        (@begin1 (newline)
          (@begin1 (print 2)
            (@begin1 (newline)
              (@begin1 (print 3)
                (@begin1 (newline) (equal? 1 2)))))))
    (@begin1 (print 111) (@begin1 (newline) (equal? 1 2)))
    (@begin1 (print 222) (@begin1 (newline) (equal? 1 2)))))

;;; RevealGlobalPass

(define (main)
  (if
      (@begin1 ((@primitive-function-ref print 1) 1)
        (@begin1 ((@primitive-function-ref newline 0))
          (@begin1 ((@primitive-function-ref print 1) 2)
            (@begin1 ((@primitive-function-ref newline 0))
              (@begin1 ((@primitive-function-ref print 1) 3)
                (@begin1
                    ((@primitive-function-ref newline 0))
                  ((@primitive-function-ref equal? 2) 1 2)))))))
    (@begin1 ((@primitive-function-ref print 1) 111)
      (@begin1 ((@primitive-function-ref newline 0))
        ((@primitive-function-ref equal? 2) 1 2)))
    (@begin1 ((@primitive-function-ref print 1) 222)
      (@begin1 ((@primitive-function-ref newline 0))
        ((@primitive-function-ref equal? 2) 1 2)))))

;;; LiftLambdaPass

(define (main)
  (if
      (@begin1 ((@primitive-function-ref print 1) 1)
        (@begin1 ((@primitive-function-ref newline 0))
          (@begin1 ((@primitive-function-ref print 1) 2)
            (@begin1 ((@primitive-function-ref newline 0))
              (@begin1 ((@primitive-function-ref print 1) 3)
                (@begin1
                    ((@primitive-function-ref newline 0))
                  ((@primitive-function-ref equal? 2) 1 2)))))))
    (@begin1 ((@primitive-function-ref print 1) 111)
      (@begin1 ((@primitive-function-ref newline 0))
        ((@primitive-function-ref equal? 2) 1 2)))
    (@begin1 ((@primitive-function-ref print 1) 222)
      (@begin1 ((@primitive-function-ref newline 0))
        ((@primitive-function-ref equal? 2) 1 2)))))

;;; UnnestOperandPass

(define (main)
  (@begin1 ((@primitive-function-ref print 1) 1)
    (@begin1 ((@primitive-function-ref newline 0))
      (@begin1 ((@primitive-function-ref print 1) 2)
        (@begin1 ((@primitive-function-ref newline 0))
          (@begin1 ((@primitive-function-ref print 1) 3)
            (@begin1 ((@primitive-function-ref newline 0))
              (@let1 _₁
                  ((@primitive-function-ref equal? 2) 1 2)
                (if _₁
                  (@begin1
                      ((@primitive-function-ref print 1) 111)
                    (@begin1
                        ((@primitive-function-ref newline 0))
                      ((@primitive-function-ref equal? 2)
                       1
                       2)))
                  (@begin1
                      ((@primitive-function-ref print 1) 222)
                    (@begin1
                        ((@primitive-function-ref newline 0))
                      ((@primitive-function-ref equal? 2)
                       1
                       2))))))))))))

