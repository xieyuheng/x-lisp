;;; Input

(define (main)
  (= x (begin (= x 4) (iadd x 1)))
  (println (iadd x 2)))

;;; ShrinkPass

(define (main)
  (let ((x (let ((x 4)) (iadd x 1)))) (println (iadd x 2))))

;;; UniquifyPass

(define (main)
  (let ((x₁ (let ((x₂ 4)) (iadd x₂ 1)))) (println (iadd x₁ 2))))

;;; RevealGlobalPass

(define (main)
  (let ((x₁ (let ((x₂ 4)) ((@primitive iadd 2) x₂ 1))))
    ((@primitive println 1) ((@primitive iadd 2) x₁ 2))))

;;; LiftLambdaPass

(define (main)
  (let ((x₁ (let ((x₂ 4)) ((@primitive iadd 2) x₂ 1))))
    ((@primitive println 1) ((@primitive iadd 2) x₁ 2))))

;;; UnnestOperandPass

(define (main)
  (let ((x₁ (let ((x₂ 4)) ((@primitive iadd 2) x₂ 1))))
    (let ((_₁ ((@primitive iadd 2) x₁ 2)))
      ((@primitive println 1) _₁))))

