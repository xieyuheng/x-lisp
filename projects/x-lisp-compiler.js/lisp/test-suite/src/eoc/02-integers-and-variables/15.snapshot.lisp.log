;;; Input

(define (main) (= x (begin (= x 4) (iadd x 1))) (println (iadd x 2)))

;;; ShrinkPass

(define (main) (@let1 x (@let1 x 4 (iadd x 1)) (println (iadd x 2))))

;;; UniquifyPass

(define (main) (@let1 x₁ (@let1 x₂ 4 (iadd x₂ 1)) (println (iadd x₁ 2))))

;;; RevealGlobalPass

(define (main)
  (@let1 x₁ (@let1 x₂ 4 ((@primitive-function-ref iadd 2) x₂ 1))
    ((@primitive-function-ref println 1) ((@primitive-function-ref iadd 2) x₁ 2))))

;;; LiftLambdaPass

(define (main)
  (@let1 x₁ (@let1 x₂ 4 ((@primitive-function-ref iadd 2) x₂ 1))
    ((@primitive-function-ref println 1) ((@primitive-function-ref iadd 2) x₁ 2))))

;;; UnnestOperandPass

(define (main)
  (@let1 x₁ (@let1 x₂ 4 ((@primitive-function-ref iadd 2) x₂ 1))
    (@let1 _₁ ((@primitive-function-ref iadd 2) x₁ 2)
      ((@primitive-function-ref println 1) _₁))))

