;;; Input

(define (main)
  (= x (iadd (iadd 1 2) (iadd 3 4)))
  (println (iadd x 5)))

;;; ShrinkPass

(define (main)
  (@let1 x ((iadd ((iadd 1) 2)) ((iadd 3) 4))
    (println ((iadd x) 5))))

;;; UniquifyPass

(define (main)
  (@let1 x₁ ((iadd ((iadd 1) 2)) ((iadd 3) 4))
    (println ((iadd x₁) 5))))

;;; RevealGlobalPass

(define (main)
  (@let1 x₁
      (((@builtin-function-ref iadd 2)
        (((@builtin-function-ref iadd 2) 1) 2))
       (((@builtin-function-ref iadd 2) 3) 4))
    ((@builtin-function-ref println 1)
     (((@builtin-function-ref iadd 2) x₁) 5))))

;;; LiftLambdaPass

(define (main)
  (@let1 x₁
      (((@builtin-function-ref iadd 2)
        (((@builtin-function-ref iadd 2) 1) 2))
       (((@builtin-function-ref iadd 2) 3) 4))
    ((@builtin-function-ref println 1)
     (((@builtin-function-ref iadd 2) x₁) 5))))

