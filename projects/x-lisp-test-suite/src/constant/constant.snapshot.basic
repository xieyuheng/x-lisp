(define-variable one)

(define-variable _one/flag #f)

(define-function _one/get
  (block body
    (= flag (load _one/flag))
    (branch flag cached init))
  (block cached (= result (load one)) (return result))
  (block init
    (= result (call (@function _one/function 0)))
    (store one result)
    (= true (literal #t))
    (store _one/flag true)
    (return result)))

(define-function _one/function
  (block body (= _↩ (literal 1)) (return _↩)))

(define-variable two)

(define-variable _two/flag #f)

(define-function _two/get
  (block body
    (= flag (load _two/flag))
    (branch flag cached init))
  (block cached (= result (load two)) (return result))
  (block init
    (= result (call (@function _two/function 0)))
    (store two result)
    (= true (literal #t))
    (store _two/flag true)
    (return result)))

(define-function _two/function
  (block body
    (= _₁ (literal (@primitive-function iadd 2)))
    (= _₂ (literal 1))
    (= _₃ (apply _₁ _₂))
    (= _₄ (call (@function _one/get 0)))
    (= _↩ (apply _₃ _₄))
    (return _↩)))

(define-variable three)

(define-variable _three/flag #f)

(define-function _three/get
  (block body
    (= flag (load _three/flag))
    (branch flag cached init))
  (block cached (= result (load three)) (return result))
  (block init
    (= result (call (@function _three/function 0)))
    (store three result)
    (= true (literal #t))
    (store _three/flag true)
    (return result)))

(define-function _three/function
  (block body
    (= _₁ (literal (@primitive-function iadd 2)))
    (= _₂ (literal 1))
    (= _₃ (apply _₁ _₂))
    (= _₄ (call (@function _two/get 0)))
    (= _↩ (apply _₃ _₄))
    (return _↩)))

(define-function _main
  (block body
    (= _₁ (literal (@primitive-function println-non-void 1)))
    (= _₂ (call (@function _three/get 0)))
    (= _↩ (apply _₁ _₂))
    (return _↩)))
