;;; Input

(define (_main)
  (println-non-void
   (iadd (iadd (iadd (iadd (random-dice) 1) 1) 1) 1)))

;;; ShrinkPass

(define (_main)
  (println-non-void
   ((iadd ((iadd ((iadd ((iadd (random-dice)) 1)) 1)) 1)) 1)))

;;; UniquifyPass

(define (_main)
  (println-non-void
   ((iadd ((iadd ((iadd ((iadd (random-dice)) 1)) 1)) 1)) 1)))

;;; RevealGlobalPass

(define (_main)
  ((@primitive-function println-non-void 1)
   (((@primitive-function iadd 2)
     (((@primitive-function iadd 2)
       (((@primitive-function iadd 2)
         (((@primitive-function iadd 2)
           ((@primitive-function random-dice 0)))
          1))
        1))
      1))
    1)))

;;; LiftLambdaPass

(define (_main)
  ((@primitive-function println-non-void 1)
   (((@primitive-function iadd 2)
     (((@primitive-function iadd 2)
       (((@primitive-function iadd 2)
         (((@primitive-function iadd 2)
           ((@primitive-function random-dice 0)))
          1))
        1))
      1))
    1)))

;;; UnnestOperandPass

(define (_main)
  (@let1 _₁ (@primitive-function println-non-void 1)
    (@let1 _₂ (@primitive-function iadd 2)
      (@let1 _₃ (@primitive-function iadd 2)
        (@let1 _₄ (@primitive-function iadd 2)
          (@let1 _₅ (@primitive-function iadd 2)
            (@let1 _₆ (@primitive-function random-dice 0)
              (@let1 _₇ (_₆)
                (@let1 _₈ (_₅ _₇)
                  (@let1 _₉ 1
                    (@let1 _₁₀ (_₈ _₉)
                      (@let1 _₁₁ (_₄ _₁₀)
                        (@let1 _₁₂ 1
                          (@let1 _₁₃ (_₁₁ _₁₂)
                            (@let1 _₁₄ (_₃ _₁₃)
                              (@let1 _₁₅ 1
                                (@let1 _₁₆ (_₁₄ _₁₅)
                                  (@let1 _₁₇ (_₂ _₁₆)
                                    (@let1 _₁₈ 1
                                      (@let1 _₁₉ (_₁₇ _₁₈)
                                        (_₁ _₁₉)))))))))))))))))))))

;;; ExplicateControlPass

(define-function _main
  (block body
    (= _₁ (literal (@primitive-function println-non-void 1)))
    (= _₂ (literal (@primitive-function iadd 2)))
    (= _₃ (literal (@primitive-function iadd 2)))
    (= _₄ (literal (@primitive-function iadd 2)))
    (= _₅ (literal (@primitive-function iadd 2)))
    (= _₆ (literal (@primitive-function random-dice 0)))
    (= _₇ (apply-nullary _₆))
    (= _₈ (apply _₅ _₇))
    (= _₉ (literal 1))
    (= _₁₀ (apply _₈ _₉))
    (= _₁₁ (apply _₄ _₁₀))
    (= _₁₂ (literal 1))
    (= _₁₃ (apply _₁₁ _₁₂))
    (= _₁₄ (apply _₃ _₁₃))
    (= _₁₅ (literal 1))
    (= _₁₆ (apply _₁₄ _₁₅))
    (= _₁₇ (apply _₂ _₁₆))
    (= _₁₈ (literal 1))
    (= _₁₉ (apply _₁₇ _₁₈))
    (= _↩ (apply _₁ _₁₉))
    (return _↩)))

(define-variable __main/constant)

(define-setup __main/setup
  (block body
    (= function-address (literal (@address _main)))
    (= arity (literal 0))
    (= size (literal 0))
    (= curry
       (call
        (@primitive-function make-curry 3)
        function-address
        arity
        size))
    (store __main/constant curry)
    (return)))

;;; SelectInstructionPass

(export _setup _main)

(define-code _main
  (block body
    (movq
     (label-imm (external-label x-println-non-void))
     (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 8) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (var _₁))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (var _₂))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (var _₃))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (var _₄))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (var _₅))
    (movq
     (label-imm (external-label x-random-dice))
     (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 0) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (var _₆))
    (movq (var _₆) (reg rdi))
    (callq-n (external-label x-apply-nullary) (arity 1))
    (movq (reg rax) (var _₇))
    (movq (var _₅) (reg rdi))
    (movq (var _₇) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (var _₈))
    (movq (imm 8) (var _₉))
    (movq (var _₈) (reg rdi))
    (movq (var _₉) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (var _₁₀))
    (movq (var _₄) (reg rdi))
    (movq (var _₁₀) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (var _₁₁))
    (movq (imm 8) (var _₁₂))
    (movq (var _₁₁) (reg rdi))
    (movq (var _₁₂) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (var _₁₃))
    (movq (var _₃) (reg rdi))
    (movq (var _₁₃) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (var _₁₄))
    (movq (imm 8) (var _₁₅))
    (movq (var _₁₄) (reg rdi))
    (movq (var _₁₅) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (var _₁₆))
    (movq (var _₂) (reg rdi))
    (movq (var _₁₆) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (var _₁₇))
    (movq (imm 8) (var _₁₈))
    (movq (var _₁₇) (reg rdi))
    (movq (var _₁₈) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (var _₁₉))
    (movq (var _₁) (reg rdi))
    (movq (var _₁₉) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (var _↩))
    (movq (var _↩) (reg rax))
    (retq)))

(define-space __main/constant 8)

(define-code __main/setup
  (block body
    (movq (label-imm (label _main)) (var function-address))
    (orq (imm 3) (var function-address))
    (movq (imm 0) (var arity))
    (movq (imm 0) (var size))
    (movq (var function-address) (reg rdi))
    (movq (var arity) (reg rsi))
    (movq (var size) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (var curry))
    (movq (var curry) (label-deref (label __main/constant)))
    (retq)))

(define-code _setup
  (block body
    (callq-n (label __main/setup) (arity 0))
    (movq (reg rax) (var _))))

;;; AssignHomePass

(export _setup _main)

(define-code _main
  (block body
    (movq
     (label-imm (external-label x-println-non-void))
     (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 8) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -64))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -72))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -80))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -88))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -96))
    (movq
     (label-imm (external-label x-random-dice))
     (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 0) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -104))
    (movq (reg-deref (reg rbp) -104) (reg rdi))
    (callq-n (external-label x-apply-nullary) (arity 1))
    (movq (reg rax) (reg-deref (reg rbp) -112))
    (movq (reg-deref (reg rbp) -96) (reg rdi))
    (movq (reg-deref (reg rbp) -112) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -120))
    (movq (imm 8) (reg-deref (reg rbp) -128))
    (movq (reg-deref (reg rbp) -120) (reg rdi))
    (movq (reg-deref (reg rbp) -128) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -136))
    (movq (reg-deref (reg rbp) -88) (reg rdi))
    (movq (reg-deref (reg rbp) -136) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -144))
    (movq (imm 8) (reg-deref (reg rbp) -152))
    (movq (reg-deref (reg rbp) -144) (reg rdi))
    (movq (reg-deref (reg rbp) -152) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -160))
    (movq (reg-deref (reg rbp) -80) (reg rdi))
    (movq (reg-deref (reg rbp) -160) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -168))
    (movq (imm 8) (reg-deref (reg rbp) -176))
    (movq (reg-deref (reg rbp) -168) (reg rdi))
    (movq (reg-deref (reg rbp) -176) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -184))
    (movq (reg-deref (reg rbp) -72) (reg rdi))
    (movq (reg-deref (reg rbp) -184) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -192))
    (movq (imm 8) (reg-deref (reg rbp) -200))
    (movq (reg-deref (reg rbp) -192) (reg rdi))
    (movq (reg-deref (reg rbp) -200) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -208))
    (movq (reg-deref (reg rbp) -64) (reg rdi))
    (movq (reg-deref (reg rbp) -208) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -216))
    (movq (reg-deref (reg rbp) -216) (reg rax))
    (retq)))

(define-space __main/constant 8)

(define-code __main/setup
  (block body
    (movq
     (label-imm (label _main))
     (reg-deref (reg rbp) -64))
    (orq (imm 3) (reg-deref (reg rbp) -64))
    (movq (imm 0) (reg-deref (reg rbp) -72))
    (movq (imm 0) (reg-deref (reg rbp) -80))
    (movq (reg-deref (reg rbp) -64) (reg rdi))
    (movq (reg-deref (reg rbp) -72) (reg rsi))
    (movq (reg-deref (reg rbp) -80) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -88))
    (movq
     (reg-deref (reg rbp) -88)
     (label-deref (label __main/constant)))
    (retq)))

(define-code _setup
  (block body
    (callq-n (label __main/setup) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -64))))

;;; PatchInstructionPass

(export _setup _main)

(define-code _main
  (block body
    (movq
     (label-imm (external-label x-println-non-void))
     (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 8) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -64))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -72))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -80))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -88))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -96))
    (movq
     (label-imm (external-label x-random-dice))
     (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 0) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -104))
    (movq (reg-deref (reg rbp) -104) (reg rdi))
    (callq-n (external-label x-apply-nullary) (arity 1))
    (movq (reg rax) (reg-deref (reg rbp) -112))
    (movq (reg-deref (reg rbp) -96) (reg rdi))
    (movq (reg-deref (reg rbp) -112) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -120))
    (movq (imm 8) (reg-deref (reg rbp) -128))
    (movq (reg-deref (reg rbp) -120) (reg rdi))
    (movq (reg-deref (reg rbp) -128) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -136))
    (movq (reg-deref (reg rbp) -88) (reg rdi))
    (movq (reg-deref (reg rbp) -136) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -144))
    (movq (imm 8) (reg-deref (reg rbp) -152))
    (movq (reg-deref (reg rbp) -144) (reg rdi))
    (movq (reg-deref (reg rbp) -152) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -160))
    (movq (reg-deref (reg rbp) -80) (reg rdi))
    (movq (reg-deref (reg rbp) -160) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -168))
    (movq (imm 8) (reg-deref (reg rbp) -176))
    (movq (reg-deref (reg rbp) -168) (reg rdi))
    (movq (reg-deref (reg rbp) -176) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -184))
    (movq (reg-deref (reg rbp) -72) (reg rdi))
    (movq (reg-deref (reg rbp) -184) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -192))
    (movq (imm 8) (reg-deref (reg rbp) -200))
    (movq (reg-deref (reg rbp) -192) (reg rdi))
    (movq (reg-deref (reg rbp) -200) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -208))
    (movq (reg-deref (reg rbp) -64) (reg rdi))
    (movq (reg-deref (reg rbp) -208) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -216))
    (movq (reg-deref (reg rbp) -216) (reg rax))
    (retq)))

(define-space __main/constant 8)

(define-code __main/setup
  (block body
    (movq
     (label-imm (label _main))
     (reg-deref (reg rbp) -64))
    (orq (imm 3) (reg-deref (reg rbp) -64))
    (movq (imm 0) (reg-deref (reg rbp) -72))
    (movq (imm 0) (reg-deref (reg rbp) -80))
    (movq (reg-deref (reg rbp) -64) (reg rdi))
    (movq (reg-deref (reg rbp) -72) (reg rsi))
    (movq (reg-deref (reg rbp) -80) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -88))
    (movq (reg-deref (reg rbp) -88) (reg rax))
    (movq (reg rax) (label-deref (label __main/constant)))
    (retq)))

(define-code _setup
  (block body
    (callq-n (label __main/setup) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -64))))

;;; PrologAndEpilogPass

(export _setup _main)

(define-code _main
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (pushq (reg rsp))
    (pushq (reg rbp))
    (pushq (reg rbx))
    (pushq (reg r12))
    (pushq (reg r13))
    (pushq (reg r14))
    (pushq (reg r15))
    (subq (imm 216) (reg rsp))
    (jmp (label body)))
  (block body
    (movq
     (label-imm (external-label x-println-non-void))
     (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 8) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -64))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -72))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -80))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -88))
    (movq (label-imm (external-label x-iadd)) (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 16) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -96))
    (movq
     (label-imm (external-label x-random-dice))
     (reg rdi))
    (orq (imm 3) (reg rdi))
    (movq (imm 0) (reg rsi))
    (movq (imm 0) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -104))
    (movq (reg-deref (reg rbp) -104) (reg rdi))
    (callq-n (external-label x-apply-nullary) (arity 1))
    (movq (reg rax) (reg-deref (reg rbp) -112))
    (movq (reg-deref (reg rbp) -96) (reg rdi))
    (movq (reg-deref (reg rbp) -112) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -120))
    (movq (imm 8) (reg-deref (reg rbp) -128))
    (movq (reg-deref (reg rbp) -120) (reg rdi))
    (movq (reg-deref (reg rbp) -128) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -136))
    (movq (reg-deref (reg rbp) -88) (reg rdi))
    (movq (reg-deref (reg rbp) -136) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -144))
    (movq (imm 8) (reg-deref (reg rbp) -152))
    (movq (reg-deref (reg rbp) -144) (reg rdi))
    (movq (reg-deref (reg rbp) -152) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -160))
    (movq (reg-deref (reg rbp) -80) (reg rdi))
    (movq (reg-deref (reg rbp) -160) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -168))
    (movq (imm 8) (reg-deref (reg rbp) -176))
    (movq (reg-deref (reg rbp) -168) (reg rdi))
    (movq (reg-deref (reg rbp) -176) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -184))
    (movq (reg-deref (reg rbp) -72) (reg rdi))
    (movq (reg-deref (reg rbp) -184) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -192))
    (movq (imm 8) (reg-deref (reg rbp) -200))
    (movq (reg-deref (reg rbp) -192) (reg rdi))
    (movq (reg-deref (reg rbp) -200) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -208))
    (movq (reg-deref (reg rbp) -64) (reg rdi))
    (movq (reg-deref (reg rbp) -208) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -216))
    (movq (reg-deref (reg rbp) -216) (reg rax))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 216) (reg rsp))
    (popq (reg r15))
    (popq (reg r14))
    (popq (reg r13))
    (popq (reg r12))
    (popq (reg rbx))
    (popq (reg rbp))
    (popq (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-space __main/constant 8)

(define-code __main/setup
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (pushq (reg rsp))
    (pushq (reg rbp))
    (pushq (reg rbx))
    (pushq (reg r12))
    (pushq (reg r13))
    (pushq (reg r14))
    (pushq (reg r15))
    (subq (imm 88) (reg rsp))
    (jmp (label body)))
  (block body
    (movq
     (label-imm (label _main))
     (reg-deref (reg rbp) -64))
    (orq (imm 3) (reg-deref (reg rbp) -64))
    (movq (imm 0) (reg-deref (reg rbp) -72))
    (movq (imm 0) (reg-deref (reg rbp) -80))
    (movq (reg-deref (reg rbp) -64) (reg rdi))
    (movq (reg-deref (reg rbp) -72) (reg rsi))
    (movq (reg-deref (reg rbp) -80) (reg rdx))
    (callq-n (external-label x-make-curry) (arity 3))
    (movq (reg rax) (reg-deref (reg rbp) -88))
    (movq (reg-deref (reg rbp) -88) (reg rax))
    (movq (reg rax) (label-deref (label __main/constant)))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 88) (reg rsp))
    (popq (reg r15))
    (popq (reg r14))
    (popq (reg r13))
    (popq (reg r12))
    (popq (reg rbx))
    (popq (reg rbp))
    (popq (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-code _setup
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (pushq (reg rsp))
    (pushq (reg rbp))
    (pushq (reg rbx))
    (pushq (reg r12))
    (pushq (reg r13))
    (pushq (reg r14))
    (pushq (reg r15))
    (subq (imm 64) (reg rsp))
    (jmp (label body)))
  (block body
    (callq-n (label __main/setup) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -64)))
  (block epilog
    (addq (imm 64) (reg rsp))
    (popq (reg r15))
    (popq (reg r14))
    (popq (reg r13))
    (popq (reg r12))
    (popq (reg rbx))
    (popq (reg rbp))
    (popq (reg rsp))
    (popq (reg rbp))
    (retq)))

