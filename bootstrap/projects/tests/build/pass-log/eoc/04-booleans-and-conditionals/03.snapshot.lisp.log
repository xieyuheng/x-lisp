;;; Input

(define (main)
  (println-non-void
   (if
       (and (equal? (random-dice) 1)
            (equal? (random-dice) 2))
     0
     42)))

;;; ShrinkPass

(define (main)
  (println-non-void
   (if
       (if (equal? (random-dice) 1)
         (equal? (random-dice) 2)
         #f)
     0
     42)))

;;; UniquifyPass

(define (main)
  (println-non-void
   (if
       (if (equal? (random-dice) 1)
         (equal? (random-dice) 2)
         #f)
     0
     42)))

;;; RevealFunctionPass

(define (main)
  ((@function println-non-void 1)
   (if
       (if
           ((@function equal? 2)
            ((@function random-dice 0))
            1)
         ((@function equal? 2) ((@function random-dice 0)) 2)
         #f)
     0
     42)))

;;; LiftLambdaPass

(define (main)
  ((@function println-non-void 1)
   (if
       (if
           ((@function equal? 2)
            ((@function random-dice 0))
            1)
         ((@function equal? 2) ((@function random-dice 0)) 2)
         #f)
     0
     42)))

;;; UnnestOperandPass

(define (main)
  (@let1 _₁ (@function println-non-void 1)
    (@let1 _₂
        (@let1 _₃
            (@let1 _₄ (@function equal? 2)
              (@let1 _₅ (@function random-dice 0)
                (@let1 _₆ (_₅)
                  (@let1 _₇ 1
                    (@let1 _₈ (_₄ _₆ _₇)
                      (if _₈
                        (@let1 _₉ (@function equal? 2)
                          (@let1 _₁₀
                              (@function random-dice 0)
                            (@let1 _₁₁ (_₁₀)
                              (@let1 _₁₂ 2 (_₉ _₁₁ _₁₂)))))
                        #f))))))
          (if _₃ 0 42))
      (_₁ _₂))))

;;; ExplicateControlPass

(define-function main
  (block entry
    (= _₁ (const (@function println-non-void 1)))
    (= _₄ (const (@function equal? 2)))
    (= _₅ (const (@function random-dice 0)))
    (= _₆ (apply _₅))
    (= _₇ (const 1))
    (= _₈ (apply _₄ _₆ _₇))
    (branch _₈ main/then₅ main/else₆))
  (block main/let-body₁ (= _↩ (apply _₁ _₂)) (return _↩))
  (block main/then₂ (= _₂ (const 0)) (goto main/let-body₁))
  (block main/else₃ (= _₂ (const 42)) (goto main/let-body₁))
  (block main/let-body₄ (branch _₃ main/then₂ main/else₃))
  (block main/then₅
    (= _₉ (const (@function equal? 2)))
    (= _₁₀ (const (@function random-dice 0)))
    (= _₁₁ (apply _₁₀))
    (= _₁₂ (const 2))
    (= _₃ (apply _₉ _₁₁ _₁₂))
    (goto main/let-body₄))
  (block main/else₆ (= _₃ (const #f)) (goto main/let-body₄)))

