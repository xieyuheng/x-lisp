;;; Input

(define (main)
  (println-non-void
   (begin
     (= x (random-dice))
     (= y (random-dice))
     (if (if (int-less? x 1) (equal? x 0) (equal? x 2))
       (iadd y 2)
       (iadd y 10)))))

;;; ShrinkPass

(define (main)
  (println-non-void
   (@let1 x (random-dice)
     (@let1 y (random-dice)
       (if
           (if ((int-less? x) 1)
             ((equal? x) 0)
             ((equal? x) 2))
         ((iadd y) 2)
         ((iadd y) 10))))))

;;; UniquifyPass

(define (main)
  (println-non-void
   (@let1 x₁ (random-dice)
     (@let1 y₁ (random-dice)
       (if
           (if ((int-less? x₁) 1)
             ((equal? x₁) 0)
             ((equal? x₁) 2))
         ((iadd y₁) 2)
         ((iadd y₁) 10))))))

;;; RevealFunctionPass

(define (main)
  ((@function println-non-void 1)
   (@let1 x₁ ((@function random-dice 0))
     (@let1 y₁ ((@function random-dice 0))
       (if
           (if (((@function int-less? 2) x₁) 1)
             (((@function equal? 2) x₁) 0)
             (((@function equal? 2) x₁) 2))
         (((@function iadd 2) y₁) 2)
         (((@function iadd 2) y₁) 10))))))

;;; LiftLambdaPass

(define (main)
  ((@function println-non-void 1)
   (@let1 x₁ ((@function random-dice 0))
     (@let1 y₁ ((@function random-dice 0))
       (if
           (if (((@function int-less? 2) x₁) 1)
             (((@function equal? 2) x₁) 0)
             (((@function equal? 2) x₁) 2))
         (((@function iadd 2) y₁) 2)
         (((@function iadd 2) y₁) 10))))))

;;; UnnestOperandPass

(define (main)
  (@let1 _₁ (@function println-non-void 1)
    (@let1 x₁ (@let1 _₂ (@function random-dice 0) (_₂))
      (@let1 y₁ (@let1 _₃ (@function random-dice 0) (_₃))
        (@let1 _₄
            (@let1 _₅
                (@let1 _₆ (@function int-less? 2)
                  (@let1 _₇ (_₆ x₁)
                    (@let1 _₈ 1
                      (@let1 _₉ (_₇ _₈)
                        (if _₉
                          (@let1 _₁₀ (@function equal? 2)
                            (@let1 _₁₁ (_₁₀ x₁)
                              (@let1 _₁₂ 0 (_₁₁ _₁₂))))
                          (@let1 _₁₃ (@function equal? 2)
                            (@let1 _₁₄ (_₁₃ x₁)
                              (@let1 _₁₅ 2 (_₁₄ _₁₅)))))))))
              (if _₅
                (@let1 _₁₆ (@function iadd 2)
                  (@let1 _₁₇ (_₁₆ y₁)
                    (@let1 _₁₈ 2 (_₁₇ _₁₈))))
                (@let1 _₁₉ (@function iadd 2)
                  (@let1 _₂₀ (_₁₉ y₁)
                    (@let1 _₂₁ 10 (_₂₀ _₂₁))))))
          (_₁ _₄))))))

;;; ExplicateControlPass

(define-function main
  (block entry
    (= _₁ (const (@function println-non-void 1)))
    (= _₂ (const (@function random-dice 0)))
    (= x₁ (nullary-apply _₂))
    (= _₃ (const (@function random-dice 0)))
    (= y₁ (nullary-apply _₃))
    (= _₆ (const (@function int-less? 2)))
    (= _₇ (apply _₆ x₁))
    (= _₈ (const 1))
    (= _₉ (apply _₇ _₈))
    (branch _₉ main/then₅ main/else₆))
  (block main/let-body₁ (= _↩ (apply _₁ _₄)) (return _↩))
  (block main/then₂
    (= _₁₆ (const (@function iadd 2)))
    (= _₁₇ (apply _₁₆ y₁))
    (= _₁₈ (const 2))
    (= _₄ (apply _₁₇ _₁₈))
    (goto main/let-body₁))
  (block main/else₃
    (= _₁₉ (const (@function iadd 2)))
    (= _₂₀ (apply _₁₉ y₁))
    (= _₂₁ (const 10))
    (= _₄ (apply _₂₀ _₂₁))
    (goto main/let-body₁))
  (block main/let-body₄ (branch _₅ main/then₂ main/else₃))
  (block main/then₅
    (= _₁₀ (const (@function equal? 2)))
    (= _₁₁ (apply _₁₀ x₁))
    (= _₁₂ (const 0))
    (= _₅ (apply _₁₁ _₁₂))
    (goto main/let-body₄))
  (block main/else₆
    (= _₁₃ (const (@function equal? 2)))
    (= _₁₄ (apply _₁₃ x₁))
    (= _₁₅ (const 2))
    (= _₅ (apply _₁₄ _₁₅))
    (goto main/let-body₄)))

;;; SelectInstructionPass

(define-code main
  (block entry)
  (block main/let-body₁ (ret (var _↩)))
  (block main/then₂)
  (block main/else₃)
  (block main/let-body₄)
  (block main/then₅)
  (block main/else₆))

