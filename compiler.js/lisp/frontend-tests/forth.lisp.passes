Input:

    (define (swap f x y) (f y x))
    
    (define (drop f) (lambda (dropped) (lambda (x) (f x))))
    
    (define (dup f) (lambda (x) (f x x)))
    
    (define (identity x) x)
    
    (define (main)
      (begin (= f identity) (= g (dup identity)) (g f f)))

ShrinkPass:

    (define (swap f x y) (f y x))
    
    (define (drop f) (lambda (dropped) (lambda (x) (f x))))
    
    (define (dup f) (lambda (x) (f x x)))
    
    (define (identity x) x)
    
    (define (main)
      (@let1 f identity (@let1 g (dup identity) (g f f))))

UniquifyPass:

    (define (swap f x y) (f y x))
    
    (define (drop f) (lambda (dropped₁) (lambda (x₁) (f x₁))))
    
    (define (dup f) (lambda (x₁) (f x₁ x₁)))
    
    (define (identity x) x)
    
    (define (main)
      (@let1 f₁ identity (@let1 g₁ (dup identity) (g₁ f₁ f₁))))

RevealFunctionPass:

    (define (swap f x y) (f y x))
    
    (define (drop f) (lambda (dropped₁) (lambda (x₁) (f x₁))))
    
    (define (dup f) (lambda (x₁) (f x₁ x₁)))
    
    (define (identity x) x)
    
    (define (main)
      (@let1 f₁ (@function identity 1)
        (@let1 g₁ ((@function dup 1) (@function identity 1))
          (g₁ f₁ f₁))))

LiftLambdaPass:

    (define (swap f x y) (f y x))
    
    (define (drop f)
      ((@function curry-put! 3)
       0
       f
       ((@function make-curry 3) (@function drop/λ₁ 2) 2 1)))
    
    (define (drop/λ₁ f dropped₁)
      ((@function curry-put! 3)
       0
       f
       ((@function make-curry 3) (@function drop/λ₁/λ₁ 2) 2 1)))
    
    (define (drop/λ₁/λ₁ f x₁) (f x₁))
    
    (define (dup f)
      ((@function curry-put! 3)
       0
       f
       ((@function make-curry 3) (@function dup/λ₁ 2) 2 1)))
    
    (define (dup/λ₁ f x₁) (f x₁ x₁))
    
    (define (identity x) x)
    
    (define (main)
      (@let1 f₁ (@function identity 1)
        (@let1 g₁ ((@function dup 1) (@function identity 1))
          (g₁ f₁ f₁))))

UnnestOperandPass:

    (define (swap f x y) (f y x))
    
    (define (drop f)
      (@let1 _₁ (@function curry-put! 3)
        (@let1 _₂ 0
          (@let1 _₃ (@function make-curry 3)
            (@let1 _₄ (@function drop/λ₁ 2)
              (@let1 _₅ 2
                (@let1 _₆ 1 (@let1 _₇ (_₃ _₄ _₅ _₆) (_₁ _₂ f _₇)))))))))
    
    (define (drop/λ₁ f dropped₁)
      (@let1 _₁ (@function curry-put! 3)
        (@let1 _₂ 0
          (@let1 _₃ (@function make-curry 3)
            (@let1 _₄ (@function drop/λ₁/λ₁ 2)
              (@let1 _₅ 2
                (@let1 _₆ 1 (@let1 _₇ (_₃ _₄ _₅ _₆) (_₁ _₂ f _₇)))))))))
    
    (define (drop/λ₁/λ₁ f x₁) (f x₁))
    
    (define (dup f)
      (@let1 _₁ (@function curry-put! 3)
        (@let1 _₂ 0
          (@let1 _₃ (@function make-curry 3)
            (@let1 _₄ (@function dup/λ₁ 2)
              (@let1 _₅ 2
                (@let1 _₆ 1 (@let1 _₇ (_₃ _₄ _₅ _₆) (_₁ _₂ f _₇)))))))))
    
    (define (dup/λ₁ f x₁) (f x₁ x₁))
    
    (define (identity x) x)
    
    (define (main)
      (@let1 f₁ (@function identity 1)
        (@let1 g₁
            (@let1 _₁ (@function dup 1)
              (@let1 _₂ (@function identity 1) (_₁ _₂)))
          (g₁ f₁ f₁))))

ExplicateControlPass:

    (define-function swap (block entry))
    
    (define-function drop (block entry))
    
    (define-function drop/λ₁ (block entry))
    
    (define-function drop/λ₁/λ₁ (block entry))
    
    (define-function dup (block entry))
    
    (define-function dup/λ₁ (block entry))
    
    (define-function identity (block entry))
    
    (define-function main (block entry))

