Input:

    (define (square x) (imul x x))
    
    (define (main) (print (square (square 3))) (newline))

ShrinkPass:

    (define (square x) (imul x x))
    
    (define (main) (@let1 _ (print (square (square 3))) (newline)))

UniquifyPass:

    (define (square x) (imul x x))
    
    (define (main) (@let1 _₁ (print (square (square 3))) (newline)))

RevealFunctionPass:

    (define (square x) ((@function imul 2) x x))
    
    (define (main)
      (@let1 _₁
          ((@function print 1)
           ((@function square 1) ((@function square 1) 3)))
        ((@function newline 0))))

LiftLambdaPass:

    (define (square x) ((@function imul 2) x x))
    
    (define (main)
      (@let1 _₁
          ((@function print 1)
           ((@function square 1) ((@function square 1) 3)))
        ((@function newline 0))))

UnnestOperandPass:

    (define (square x) (@let1 _₁ (@function imul 2) (_₁ x x)))
    
    (define (main)
      (@let1 _₁
          (@let1 _₁ (@function print 1)
            (@let1 _₂ (@function square 1)
              (@let1 _₃ (@function square 1)
                (@let1 _₄ 3
                  (@let1 _₅ (_₃ _₄) (@let1 _₆ (_₂ _₅) (_₁ _₆)))))))
        (@let1 _₇ (@function newline 0) (_₇))))

ExplicateControlPass:

    (define-function square
      (block entry
        (= x (argument 0))
        (= _₁ (const (@function imul 2)))
        (= _↩ (apply _₁ x x))
        (return _↩)))
    
    (define-function main
      (block entry
        (= _₁ (const (@function print 1)))
        (= _₂ (const (@function square 1)))
        (= _₃ (const (@function square 1)))
        (= _₄ (const 3))
        (= _₅ (apply _₃ _₄))
        (= _₆ (apply _₂ _₅))
        (= _₁ (apply _₁ _₆))
        (= _₇ (const (@function newline 0)))
        (= _↩ (apply _₇))
        (return _↩)))

