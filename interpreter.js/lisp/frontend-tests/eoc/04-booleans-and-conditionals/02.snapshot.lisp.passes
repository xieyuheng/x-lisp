;;; Input

(define (main)
  (println-non-void
   (begin
     (= x (random-dice))
     (= y (random-dice))
     (iadd
      (if (if (int-less? x 1) (equal? x 0) (equal? x 2))
        (iadd y 2)
        (iadd y 10))
      (if (if (int-less? x 1) (equal? x 0) (equal? x 2))
        (iadd y 2)
        (iadd y 10))))))

;;; ShrinkPass

(define (main)
  (println-non-void
   (@let1 x (random-dice)
     (@let1 y (random-dice)
       (iadd
        (if (if (int-less? x 1) (equal? x 0) (equal? x 2))
          (iadd y 2)
          (iadd y 10))
        (if (if (int-less? x 1) (equal? x 0) (equal? x 2))
          (iadd y 2)
          (iadd y 10)))))))

;;; UniquifyPass

(define (main)
  (println-non-void
   (@let1 x₁ (random-dice)
     (@let1 y₁ (random-dice)
       (iadd
        (if
            (if (int-less? x₁ 1)
              (equal? x₁ 0)
              (equal? x₁ 2))
          (iadd y₁ 2)
          (iadd y₁ 10))
        (if
            (if (int-less? x₁ 1)
              (equal? x₁ 0)
              (equal? x₁ 2))
          (iadd y₁ 2)
          (iadd y₁ 10)))))))

;;; RevealFunctionPass

(define (main)
  ((@function println-non-void 1)
   (@let1 x₁ ((@function random-dice 0))
     (@let1 y₁ ((@function random-dice 0))
       ((@function iadd 2)
        (if
            (if ((@function int-less? 2) x₁ 1)
              ((@function equal? 2) x₁ 0)
              ((@function equal? 2) x₁ 2))
          ((@function iadd 2) y₁ 2)
          ((@function iadd 2) y₁ 10))
        (if
            (if ((@function int-less? 2) x₁ 1)
              ((@function equal? 2) x₁ 0)
              ((@function equal? 2) x₁ 2))
          ((@function iadd 2) y₁ 2)
          ((@function iadd 2) y₁ 10)))))))

;;; LiftLambdaPass

(define (main)
  ((@function println-non-void 1)
   (@let1 x₁ ((@function random-dice 0))
     (@let1 y₁ ((@function random-dice 0))
       ((@function iadd 2)
        (if
            (if ((@function int-less? 2) x₁ 1)
              ((@function equal? 2) x₁ 0)
              ((@function equal? 2) x₁ 2))
          ((@function iadd 2) y₁ 2)
          ((@function iadd 2) y₁ 10))
        (if
            (if ((@function int-less? 2) x₁ 1)
              ((@function equal? 2) x₁ 0)
              ((@function equal? 2) x₁ 2))
          ((@function iadd 2) y₁ 2)
          ((@function iadd 2) y₁ 10)))))))

;;; UnnestOperandPass

(define (main)
  (@let1 _₁ (@function println-non-void 1)
    (@let1 x₁ (@let1 _₂ (@function random-dice 0) (_₂))
      (@let1 y₁ (@let1 _₃ (@function random-dice 0) (_₃))
        (@let1 _₄ (@function iadd 2)
          (@let1 _₅
              (@let1 _₆
                  (@let1 _₇ (@function int-less? 2)
                    (@let1 _₈ 1
                      (@let1 _₉ (_₇ x₁ _₈)
                        (if _₉
                          (@let1 _₁₀ (@function equal? 2)
                            (@let1 _₁₁ 0 (_₁₀ x₁ _₁₁)))
                          (@let1 _₁₂ (@function equal? 2)
                            (@let1 _₁₃ 2 (_₁₂ x₁ _₁₃)))))))
                (if _₆
                  (@let1 _₁₄ (@function iadd 2)
                    (@let1 _₁₅ 2 (_₁₄ y₁ _₁₅)))
                  (@let1 _₁₆ (@function iadd 2)
                    (@let1 _₁₇ 10 (_₁₆ y₁ _₁₇)))))
            (@let1 _₁₈
                (@let1 _₁₉
                    (@let1 _₂₀ (@function int-less? 2)
                      (@let1 _₂₁ 1
                        (@let1 _₂₂ (_₂₀ x₁ _₂₁)
                          (if _₂₂
                            (@let1 _₂₃ (@function equal? 2)
                              (@let1 _₂₄ 0 (_₂₃ x₁ _₂₄)))
                            (@let1 _₂₅ (@function equal? 2)
                              (@let1 _₂₆ 2 (_₂₅ x₁ _₂₆)))))))
                  (if _₁₉
                    (@let1 _₂₇ (@function iadd 2)
                      (@let1 _₂₈ 2 (_₂₇ y₁ _₂₈)))
                    (@let1 _₂₉ (@function iadd 2)
                      (@let1 _₃₀ 10 (_₂₉ y₁ _₃₀)))))
              (@let1 _₃₁ (_₄ _₅ _₁₈) (_₁ _₃₁)))))))))

;;; ExplicateControlPass

(define-function main
  (block entry
    (= _₁ (const (@function println-non-void 1)))
    (= _₂ (const (@function random-dice 0)))
    (= x₁ (apply _₂))
    (= _₃ (const (@function random-dice 0)))
    (= y₁ (apply _₃))
    (= _₄ (const (@function iadd 2)))
    (= _₇ (const (@function int-less? 2)))
    (= _₈ (const 1))
    (= _₉ (apply _₇ x₁ _₈))
    (branch _₉ main/then₁₁ main/else₁₂))
  (block main/let-body₁
    (= _₃₁ (apply _₄ _₅ _₁₈))
    (= _↩ (apply _₁ _₃₁))
    (return _↩))
  (block main/then₂
    (= _₂₇ (const (@function iadd 2)))
    (= _₂₈ (const 2))
    (= _₁₈ (apply _₂₇ y₁ _₂₈))
    (goto main/let-body₁))
  (block main/else₃
    (= _₂₉ (const (@function iadd 2)))
    (= _₃₀ (const 10))
    (= _₁₈ (apply _₂₉ y₁ _₃₀))
    (goto main/let-body₁))
  (block main/let-body₄ (branch _₁₉ main/then₂ main/else₃))
  (block main/then₅
    (= _₂₃ (const (@function equal? 2)))
    (= _₂₄ (const 0))
    (= _₁₉ (apply _₂₃ x₁ _₂₄))
    (goto main/let-body₄))
  (block main/else₆
    (= _₂₅ (const (@function equal? 2)))
    (= _₂₆ (const 2))
    (= _₁₉ (apply _₂₅ x₁ _₂₆))
    (goto main/let-body₄))
  (block main/let-body₇
    (= _₂₀ (const (@function int-less? 2)))
    (= _₂₁ (const 1))
    (= _₂₂ (apply _₂₀ x₁ _₂₁))
    (branch _₂₂ main/then₅ main/else₆))
  (block main/then₈
    (= _₁₄ (const (@function iadd 2)))
    (= _₁₅ (const 2))
    (= _₅ (apply _₁₄ y₁ _₁₅))
    (goto main/let-body₇))
  (block main/else₉
    (= _₁₆ (const (@function iadd 2)))
    (= _₁₇ (const 10))
    (= _₅ (apply _₁₆ y₁ _₁₇))
    (goto main/let-body₇))
  (block main/let-body₁₀ (branch _₆ main/then₈ main/else₉))
  (block main/then₁₁
    (= _₁₀ (const (@function equal? 2)))
    (= _₁₁ (const 0))
    (= _₆ (apply _₁₀ x₁ _₁₁))
    (goto main/let-body₁₀))
  (block main/else₁₂
    (= _₁₂ (const (@function equal? 2)))
    (= _₁₃ (const 2))
    (= _₆ (apply _₁₂ x₁ _₁₃))
    (goto main/let-body₁₀)))

